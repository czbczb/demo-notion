{"ast":null,"code":"import _objectSpread from \"/Users/mobvista/cui_workspace/notion/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"/Users/mobvista/cui_workspace/notion/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/mobvista/cui_workspace/notion/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/mobvista/cui_workspace/notion/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/mobvista/cui_workspace/notion/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/mobvista/cui_workspace/notion/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/mobvista/cui_workspace/notion/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/mobvista/cui_workspace/notion/src/editablePage.js\";\nimport React from \"react\";\nimport \"./styles.css\";\nimport EditableBlock from \"./editableBlock\";\nimport MaxEditor from \"./maxEditor\";\nimport uid from \"./utils/uid\";\nimport { setCaretToEnd } from \"./utils/caretHelpers\";\nvar initialBlock = {\n  id: uid(),\n  html: \"\",\n  tag: \"p\"\n};\n\nvar EditablePage = /*#__PURE__*/function (_React$Component) {\n  _inherits(EditablePage, _React$Component);\n\n  var _super = _createSuper(EditablePage);\n\n  function EditablePage(props) {\n    var _this;\n\n    _classCallCheck(this, EditablePage);\n\n    _this = _super.call(this, props);\n    _this.updatePageHandler = _this.updatePageHandler.bind(_assertThisInitialized(_this));\n    _this.addBlockHandler = _this.addBlockHandler.bind(_assertThisInitialized(_this));\n    _this.deleteBlockHandler = _this.deleteBlockHandler.bind(_assertThisInitialized(_this));\n    _this.state = {\n      blocks: [initialBlock]\n    };\n    return _this;\n  }\n\n  _createClass(EditablePage, [{\n    key: \"updatePageHandler\",\n    value: function updatePageHandler(updatedBlock) {\n      var blocks = this.state.blocks;\n      var index = blocks.map(function (b) {\n        return b.id;\n      }).indexOf(updatedBlock.id);\n\n      var updatedBlocks = _toConsumableArray(blocks);\n\n      updatedBlocks[index] = _objectSpread(_objectSpread({}, updatedBlocks[index]), {}, {\n        tag: updatedBlock.tag,\n        html: updatedBlock.html\n      });\n      this.setState({\n        blocks: updatedBlocks\n      });\n    }\n  }, {\n    key: \"addBlockHandler\",\n    value: function addBlockHandler(currentBlock) {\n      var newBlock = {\n        id: uid(),\n        html: \"\",\n        tag: \"p\"\n      };\n      var blocks = this.state.blocks;\n      var index = blocks.map(function (b) {\n        return b.id;\n      }).indexOf(currentBlock.id);\n\n      var updatedBlocks = _toConsumableArray(blocks);\n\n      updatedBlocks.splice(index + 1, 0, newBlock);\n      this.setState({\n        blocks: updatedBlocks\n      }, function () {\n        currentBlock.ref.nextElementSibling.focus();\n      });\n    }\n  }, {\n    key: \"deleteBlockHandler\",\n    value: function deleteBlockHandler(currentBlock) {\n      // Only delete the block, if there is a preceding one\n      var previousBlock = currentBlock.ref.previousElementSibling;\n\n      if (previousBlock) {\n        var blocks = this.state.blocks;\n        var index = blocks.map(function (b) {\n          return b.id;\n        }).indexOf(currentBlock.id);\n\n        var updatedBlocks = _toConsumableArray(blocks);\n\n        updatedBlocks.splice(index, 1);\n        this.setState({\n          blocks: updatedBlocks\n        }, function () {\n          setCaretToEnd(previousBlock);\n          previousBlock.focus();\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var html = /*#__PURE__*/React.createElement(MaxEditor, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 18\n        }\n      });\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Page\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 7\n        }\n      }, this.state.blocks.map(function (block, key) {\n        return /*#__PURE__*/React.createElement(EditableBlock, {\n          key: key,\n          id: block.id,\n          tag: block.tag,\n          html: html,\n          updatePage: _this2.updatePageHandler,\n          addBlock: _this2.addBlockHandler,\n          deleteBlock: _this2.deleteBlockHandler,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 13\n          }\n        });\n      }));\n    }\n  }]);\n\n  return EditablePage;\n}(React.Component);\n\nexport default EditablePage;","map":{"version":3,"names":["React","EditableBlock","MaxEditor","uid","setCaretToEnd","initialBlock","id","html","tag","EditablePage","props","updatePageHandler","bind","addBlockHandler","deleteBlockHandler","state","blocks","updatedBlock","index","map","b","indexOf","updatedBlocks","setState","currentBlock","newBlock","splice","ref","nextElementSibling","focus","previousBlock","previousElementSibling","block","key","Component"],"sources":["/Users/mobvista/cui_workspace/notion/src/editablePage.js"],"sourcesContent":["import React from \"react\";\n\nimport \"./styles.css\";\nimport EditableBlock from \"./editableBlock\";\nimport MaxEditor from \"./maxEditor\";\nimport uid from \"./utils/uid\";\nimport { setCaretToEnd } from \"./utils/caretHelpers\";\n\nconst initialBlock = { id: uid(), html: \"\", tag: \"p\" };\n\nclass EditablePage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.updatePageHandler = this.updatePageHandler.bind(this);\n    this.addBlockHandler = this.addBlockHandler.bind(this);\n    this.deleteBlockHandler = this.deleteBlockHandler.bind(this);\n    this.state = { blocks: [initialBlock] };\n  }\n\n  updatePageHandler(updatedBlock) {\n    const blocks = this.state.blocks;\n    const index = blocks.map((b) => b.id).indexOf(updatedBlock.id);\n    const updatedBlocks = [...blocks];\n    updatedBlocks[index] = {\n      ...updatedBlocks[index],\n      tag: updatedBlock.tag,\n      html: updatedBlock.html\n    };\n    this.setState({ blocks: updatedBlocks });\n  }\n\n  addBlockHandler(currentBlock) {\n    const newBlock = { id: uid(), html: \"\", tag: \"p\" };\n    const blocks = this.state.blocks;\n    const index = blocks.map((b) => b.id).indexOf(currentBlock.id);\n    const updatedBlocks = [...blocks];\n    updatedBlocks.splice(index + 1, 0, newBlock);\n    this.setState({ blocks: updatedBlocks }, () => {\n      currentBlock.ref.nextElementSibling.focus();\n    });\n  }\n\n  deleteBlockHandler(currentBlock) {\n    // Only delete the block, if there is a preceding one\n    const previousBlock = currentBlock.ref.previousElementSibling;\n    if (previousBlock) {\n      const blocks = this.state.blocks;\n      const index = blocks.map((b) => b.id).indexOf(currentBlock.id);\n      const updatedBlocks = [...blocks];\n      updatedBlocks.splice(index, 1);\n      this.setState({ blocks: updatedBlocks }, () => {\n        setCaretToEnd(previousBlock);\n        previousBlock.focus();\n      });\n    }\n  }\n\n  render() {\n    const html = <MaxEditor></MaxEditor>\n    return (\n      <div className=\"Page\">\n        {this.state.blocks.map((block, key) => {\n          return (\n            <EditableBlock\n              key={key}\n              id={block.id}\n              tag={block.tag}\n              html={html}\n              updatePage={this.updatePageHandler}\n              addBlock={this.addBlockHandler}\n              deleteBlock={this.deleteBlockHandler}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nexport default EditablePage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}